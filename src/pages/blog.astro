---
import Base from '../layouts/Base.astro'
import BlogArticle from '../components/homepage/BlogArticle.astro'
import AuthorFact from '../components/AuthorFact.astro'
import {sortPosts, getPublishedPosts} from '../js/utilities'

const posts = await Astro.glob('./blog/*.md')
const publishedPosts = getPublishedPosts(posts)
const sortedPosts = sortPosts(publishedPosts)
const firstPost = sortedPosts.shift()
---

<style>
  .blog-feature {
    margin-bottom: 2em;
  }
  
  .blog-feature__text {
    margin-bottom: 1em;
  }

  @media screen and (min-width: 500px) {
    .blog-feature {
      display: grid;
      gap: 1em;
      grid-template-columns: repeat(2, 1fr);
      grid-template-areas:
        "featureImage featureText"
        "cardRow      cardRow";
    }
    .blog-feature__img {
      height: 300px;
      margin-bottom: unset;
      grid-area: featureImage;
    }
    .blog-feature__text {
      margin-bottom: unset;
      grid-area: featureText;
    }
    .card__row {
      grid-area: cardRow;
    }
  }
</style>

<Base>
  <div class="container--max-width container--base-padding">
    <h1 class="page__title">My Thoughts</h1>
    <h2>My experiences in my own words</h2>
    <div class="blog-feature">
      <a href={firstPost.url}><img class="blog-feature__img card__image" src={firstPost.frontmatter.featuredImage} alt={firstPost.frontmatter.featuredImageAlt}/></a>
      <div class="blog-feature__text">
        <h3><a class="brand-link" href={firstPost.url}>{firstPost.frontmatter.title}</a></h3>
        <p>{firstPost.frontmatter.description}</p>
        <a class="brand-link brand-link--callout" href={firstPost.url}>Read More</a>
      </div>
      <div class="card__row">
        {sortedPosts.map(post => <BlogArticle {post} />)}
      </div>
    </div>
    <AuthorFact />
  </div>
</Base>